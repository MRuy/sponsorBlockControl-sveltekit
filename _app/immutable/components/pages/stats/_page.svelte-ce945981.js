import{S as wt,i as gt,s as kt,a as C,k as n,v as Dt,W as It,h as o,c as w,l as r,m as i,w as Rt,n as T,b as W,D as t,x as Ut,f as yt,t as Lt,y as At,G as bt,o as Bt,q as b,r as E,I as Ht,u as J,U as Et}from"../../../chunks/index-a74698fd.js";import{w as Nt,C as Ot}from"../../../chunks/config-1a541b95.js";import{a as Gt,S as q}from"../../../chunks/Status-b63e8986.js";import{m as Tt}from"../../../chunks/utils-00bd27bd.js";const it=Nt("cache",{totalstats:{apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0},totalstats_time:0});function Ct(d){let _,a,s,h,c,v,l,e=d[1].apiUsers.toLocaleString()+"",p,f,m,U,Q,X,D,N=d[1].viewCount.toLocaleString()+"",K,Z,x,I,y,tt,et,L,O=d[1].totalSubmissions.toLocaleString()+"",M,st,R,A,at,lt,B,G=Tt(d[1].minutesSaved,!0)+"",P,V,H,g,ot,$,nt,ut;return{c(){_=n("table"),a=n("tbody"),s=n("tr"),h=n("th"),c=b("API Users:"),v=C(),l=n("td"),p=b(e),f=C(),m=n("tr"),U=n("th"),Q=b("Skip Count:"),X=C(),D=n("td"),K=b(N),Z=b(" skips"),x=C(),I=n("tr"),y=n("th"),tt=b("Submissions:"),et=C(),L=n("td"),M=b(O),st=C(),R=n("tr"),A=n("th"),at=b("Time Saved:"),lt=C(),B=n("td"),P=b(G),V=C(),H=n("div"),g=n("button"),ot=b("Refresh"),this.h()},l(u){_=r(u,"TABLE",{class:!0});var S=i(_);a=r(S,"TBODY",{});var k=i(a);s=r(k,"TR",{});var j=i(s);h=r(j,"TH",{class:!0});var ct=i(h);c=E(ct,"API Users:"),ct.forEach(o),v=w(j),l=r(j,"TD",{class:!0});var ft=i(l);p=E(ft,e),ft.forEach(o),j.forEach(o),f=w(k),m=r(k,"TR",{});var z=i(m);U=r(z,"TH",{class:!0});var _t=i(U);Q=E(_t,"Skip Count:"),_t.forEach(o),X=w(z),D=r(z,"TD",{class:!0});var rt=i(D);K=E(rt,N),Z=E(rt," skips"),rt.forEach(o),z.forEach(o),x=w(k),I=r(k,"TR",{});var Y=i(I);y=r(Y,"TH",{class:!0});var dt=i(y);tt=E(dt,"Submissions:"),dt.forEach(o),et=w(Y),L=r(Y,"TD",{class:!0});var ht=i(L);M=E(ht,O),ht.forEach(o),Y.forEach(o),st=w(k),R=r(k,"TR",{});var F=i(R);A=r(F,"TH",{class:!0});var mt=i(A);at=E(mt,"Time Saved:"),mt.forEach(o),lt=w(F),B=r(F,"TD",{class:!0});var vt=i(B);P=E(vt,G),vt.forEach(o),F.forEach(o),k.forEach(o),S.forEach(o),V=w(u),H=r(u,"DIV",{});var pt=i(H);g=r(pt,"BUTTON",{});var St=i(g);ot=E(St,"Refresh"),St.forEach(o),pt.forEach(o),this.h()},h(){T(h,"class","svelte-n43nsu"),T(l,"class","svelte-n43nsu"),T(U,"class","svelte-n43nsu"),T(D,"class","svelte-n43nsu"),T(y,"class","svelte-n43nsu"),T(L,"class","svelte-n43nsu"),T(A,"class","svelte-n43nsu"),T(B,"class","svelte-n43nsu"),T(_,"class","stats-table svelte-n43nsu"),g.disabled=$=d[0]===q.WORKING},m(u,S){W(u,_,S),t(_,a),t(a,s),t(s,h),t(h,c),t(s,v),t(s,l),t(l,p),t(a,f),t(a,m),t(m,U),t(U,Q),t(m,X),t(m,D),t(D,K),t(D,Z),t(a,x),t(a,I),t(I,y),t(y,tt),t(I,et),t(I,L),t(L,M),t(a,st),t(a,R),t(R,A),t(A,at),t(R,lt),t(R,B),t(B,P),W(u,V,S),W(u,H,S),t(H,g),t(g,ot),nt||(ut=Ht(g,"click",d[3]),nt=!0)},p(u,S){S&2&&e!==(e=u[1].apiUsers.toLocaleString()+"")&&J(p,e),S&2&&N!==(N=u[1].viewCount.toLocaleString()+"")&&J(K,N),S&2&&O!==(O=u[1].totalSubmissions.toLocaleString()+"")&&J(M,O),S&2&&G!==(G=Tt(u[1].minutesSaved,!0)+"")&&J(P,G),S&1&&$!==($=u[0]===q.WORKING)&&(g.disabled=$)},d(u){u&&o(_),u&&o(V),u&&o(H),nt=!1,ut()}}}function Wt(d){let _,a,s,h,c,v,l=d[1]&&Ct(d);return c=new Gt({props:{status:d[0]}}),{c(){_=C(),a=n("main"),s=n("div"),l&&l.c(),h=C(),Dt(c.$$.fragment),this.h()},l(e){It('[data-svelte="svelte-15xz8eh"]',document.head).forEach(o),_=w(e),a=r(e,"MAIN",{});var f=i(a);s=r(f,"DIV",{class:!0});var m=i(s);l&&l.l(m),h=w(m),Rt(c.$$.fragment,m),m.forEach(o),f.forEach(o),this.h()},h(){document.title="Stats | SponsorBlockControl",T(s,"class","container")},m(e,p){W(e,_,p),W(e,a,p),t(a,s),l&&l.m(s,null),t(s,h),Ut(c,s,null),v=!0},p(e,[p]){e[1]?l?l.p(e,p):(l=Ct(e),l.c(),l.m(s,h)):l&&(l.d(1),l=null);const f={};p&1&&(f.status=e[0]),c.$set(f)},i(e){v||(yt(c.$$.fragment,e),v=!0)},o(e){Lt(c.$$.fragment,e),v=!1},d(e){e&&o(_),e&&o(a),l&&l.d(),At(c)}}}const qt=6e5;function Kt(d,_,a){let s,h;bt(d,it,f=>a(4,s=f)),bt(d,Ot,f=>a(5,h=f));let c=q.IDLE,v={apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0};async function l(){a(0,c=q.WORKING);const f=await fetch(`${h.sponsorBlockApi}/api/getTotalStats`).then(m=>m.json());return a(0,c=q.SUCCESS),f}async function e(){a(1,v=await l()),Et(it,s.totalstats=v,s),Et(it,s.totalstats_time=Date.now(),s)}return Bt(async()=>{"totalstats"in s&&s.totalstats_time+qt>Date.now()?a(1,v=s.totalstats):await e()}),[c,v,e,async f=>{await e()}]}class jt extends wt{constructor(_){super(),gt(this,_,Kt,Wt,kt,{})}}export{jt as default};
