import{S as ie,i as pe,s as _e,a as T,k as f,q as z,v as fe,W as ce,h as c,c as O,l as d,m as I,r as F,w as de,n as v,H as re,b as le,D as t,a8 as V,x as me,I as q,f as he,t as Ue,y as ge,R as Ie,G as oe,U as ue}from"../../../chunks/index-a74698fd.js";import{C as Ee}from"../../../chunks/config-1a541b95.js";import{U as M}from"../../../chunks/userInfo-77587a4c.js";import{u as ve,a as Ne}from"../../../chunks/utils-e0c09108.js";import{a as De,S as U}from"../../../chunks/Status-b63e8986.js";function Re(n){let w,s,l,r,u,g,E,A,a,B,m,L,G,W,i,N,K,y,o,C,p,D,_,J,R,Q,Y,X,S,k,$,ee;return S=new De({props:{status:n[4]}}),{c(){w=T(),s=f("main"),l=f("div"),r=f("div"),u=f("fieldset"),g=f("legend"),E=z("Your Username:"),A=T(),a=f("input"),B=T(),m=f("button"),L=z("Change"),W=T(),i=f("fieldset"),N=f("legend"),K=z("Change Username: "),y=f("span"),o=z("(Admin Only)"),C=T(),p=f("input"),D=T(),_=f("input"),J=T(),R=f("button"),Q=z("Update"),X=T(),fe(S.$$.fragment),this.h()},l(e){ce('[data-svelte="svelte-azqn3g"]',document.head).forEach(c),w=O(e),s=d(e,"MAIN",{});var H=I(s);l=d(H,"DIV",{class:!0});var Z=I(l);r=d(Z,"DIV",{class:!0});var j=I(r);u=d(j,"FIELDSET",{});var P=I(u);g=d(P,"LEGEND",{});var te=I(g);E=F(te,"Your Username:"),te.forEach(c),A=O(P),a=d(P,"INPUT",{type:!0,placeholder:!0}),B=O(P),m=d(P,"BUTTON",{});var se=I(m);L=F(se,"Change"),se.forEach(c),P.forEach(c),W=O(j),i=d(j,"FIELDSET",{});var b=I(i);N=d(b,"LEGEND",{});var x=I(N);K=F(x,"Change Username: "),y=d(x,"SPAN",{class:!0});var ae=I(y);o=F(ae,"(Admin Only)"),ae.forEach(c),x.forEach(c),C=O(b),p=d(b,"INPUT",{type:!0,placeholder:!0}),D=O(b),_=d(b,"INPUT",{type:!0,placeholder:!0}),J=O(b),R=d(b,"BUTTON",{});var ne=I(R);Q=F(ne,"Update"),ne.forEach(c),b.forEach(c),j.forEach(c),X=O(Z),de(S.$$.fragment,Z),Z.forEach(c),H.forEach(c),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),m.disabled=G=n[0].length==0,v(y,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(_,"type","text"),v(_,"placeholder","Username..."),R.disabled=Y=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(l,"class","container")},m(e,h){le(e,w,h),le(e,s,h),t(s,l),t(l,r),t(r,u),t(u,g),t(g,E),t(u,A),t(u,a),V(a,n[5].userName),t(u,B),t(u,m),t(m,L),t(r,W),t(r,i),t(i,N),t(N,K),t(N,y),t(y,o),t(i,C),t(i,p),V(p,n[2]),t(i,D),t(i,_),V(_,n[1]),t(i,J),t(i,R),t(R,Q),t(l,X),me(S,l,null),k=!0,$||(ee=[q(a,"input",n[9]),q(m,"click",n[10]),q(p,"input",n[11]),q(p,"input",n[12]),q(_,"input",n[13]),q(R,"click",n[14])],$=!0)},p(e,[h]){h&32&&a.value!==e[5].userName&&V(a,e[5].userName),(!k||h&1&&G!==(G=e[0].length==0))&&(m.disabled=G),h&4&&p.value!==e[2]&&V(p,e[2]),h&2&&_.value!==e[1]&&V(_,e[1]),(!k||h&10&&Y!==(Y=!e[3]||e[1].length===0))&&(R.disabled=Y),(!k||h&16)&&re(r,"working",e[4]===U.WORKING);const H={};h&16&&(H.status=e[4]),S.$set(H)},i(e){k||(he(S.$$.fragment,e),k=!0)},o(e){Ue(S.$$.fragment,e),k=!1},d(e){e&&c(w),e&&c(s),ge(S),$=!1,Ie(ee)}}}function Se(n,w,s){let l,r;oe(n,M,o=>s(5,l=o)),oe(n,Ee,o=>s(6,r=o));let u="",g="",E="",A=!1,a=U.IDLE;async function B(){s(4,a=U.WORKING);const o=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(o.status===200){const C=await o.json();return s(4,a=U.SUCCESS),C.userName}return o.status===400&&s(4,a=U.ERROR_INVALID),o.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function m(o,C,p=void 0){s(4,a=U.WORKING);const D=new URLSearchParams;D.set("userID",o),D.set("username",C),p&&D.set("adminUserID",p);const _=await fetch(`${r.sponsorBlockApi}/api/setUsername?${D}`,{method:"POST"});_.status===200&&(s(4,a=U.SUCCESS),await ve()),_.status===400&&s(4,a=U.ERROR_INVALID),_.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function L(){s(0,u=await B()),ue(M,l.userName=u,l),ue(M,l._lastUpdateTime=Date.now(),l)}function G(){l.userName=this.value,M.set(l)}const W=async o=>{await m(r.privateUUID,u),await L()};function i(){E=this.value,s(2,E)}const N=o=>{s(3,A=Ne(E))};function K(){g=this.value,s(1,g)}return[u,g,E,A,a,l,r,m,L,G,W,i,N,K,o=>{m(E,g,r.privateUUID)}]}class Ce extends ie{constructor(w){super(),pe(this,w,Se,Re,_e,{})}}export{Ce as default};
