import{S as ie,i as pe,s as _e,a as T,k as f,q as z,v as fe,W as ce,h as c,c as O,l as d,m as I,r as F,w as de,n as v,H as re,b as le,D as t,a8 as V,x as me,I as q,f as he,t as Ue,y as ge,R as Ie,G as oe,U as ue}from"../../../chunks/index-a74698fd.js";import{C as Ee}from"../../../chunks/config-1a541b95.js";import{U as x}from"../../../chunks/userInfo-77587a4c.js";import{u as ve,a as De}from"../../../chunks/utils-e0c09108.js";import{a as Ne,S as U}from"../../../chunks/Status-b63e8986.js";function Re(n){let w,s,u,r,o,g,E,A,a,B,m,L,G,W,i,D,K,y,l,C,p,N,_,M,R,J,Y,Q,S,k,X,ee;return S=new Ne({props:{status:n[4]}}),{c(){w=T(),s=f("main"),u=f("div"),r=f("div"),o=f("fieldset"),g=f("legend"),E=z("Your Username:"),A=T(),a=f("input"),B=T(),m=f("button"),L=z("Change"),W=T(),i=f("fieldset"),D=f("legend"),K=z("Change Username: "),y=f("span"),l=z("(Admin Only)"),C=T(),p=f("input"),N=T(),_=f("input"),M=T(),R=f("button"),J=z("Update"),Q=T(),fe(S.$$.fragment),this.h()},l(e){ce('[data-svelte="svelte-azqn3g"]',document.head).forEach(c),w=O(e),s=d(e,"MAIN",{});var H=I(s);u=d(H,"DIV",{class:!0});var Z=I(u);r=d(Z,"DIV",{class:!0});var j=I(r);o=d(j,"FIELDSET",{});var P=I(o);g=d(P,"LEGEND",{});var te=I(g);E=F(te,"Your Username:"),te.forEach(c),A=O(P),a=d(P,"INPUT",{type:!0,placeholder:!0}),B=O(P),m=d(P,"BUTTON",{});var se=I(m);L=F(se,"Change"),se.forEach(c),P.forEach(c),W=O(j),i=d(j,"FIELDSET",{});var b=I(i);D=d(b,"LEGEND",{});var $=I(D);K=F($,"Change Username: "),y=d($,"SPAN",{class:!0});var ae=I(y);l=F(ae,"(Admin Only)"),ae.forEach(c),$.forEach(c),C=O(b),p=d(b,"INPUT",{type:!0,placeholder:!0}),N=O(b),_=d(b,"INPUT",{type:!0,placeholder:!0}),M=O(b),R=d(b,"BUTTON",{});var ne=I(R);J=F(ne,"Update"),ne.forEach(c),b.forEach(c),j.forEach(c),Q=O(Z),de(S.$$.fragment,Z),Z.forEach(c),H.forEach(c),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),m.disabled=G=n[0].length==0,v(y,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(_,"type","text"),v(_,"placeholder","Username..."),R.disabled=Y=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(u,"class","container")},m(e,h){le(e,w,h),le(e,s,h),t(s,u),t(u,r),t(r,o),t(o,g),t(g,E),t(o,A),t(o,a),V(a,n[0]),t(o,B),t(o,m),t(m,L),t(r,W),t(r,i),t(i,D),t(D,K),t(D,y),t(y,l),t(i,C),t(i,p),V(p,n[2]),t(i,N),t(i,_),V(_,n[1]),t(i,M),t(i,R),t(R,J),t(u,Q),me(S,u,null),k=!0,X||(ee=[q(a,"input",n[8]),q(m,"click",n[9]),q(p,"input",n[10]),q(p,"input",n[11]),q(_,"input",n[12]),q(R,"click",n[13])],X=!0)},p(e,[h]){h&1&&a.value!==e[0]&&V(a,e[0]),(!k||h&1&&G!==(G=e[0].length==0))&&(m.disabled=G),h&4&&p.value!==e[2]&&V(p,e[2]),h&2&&_.value!==e[1]&&V(_,e[1]),(!k||h&10&&Y!==(Y=!e[3]||e[1].length===0))&&(R.disabled=Y),(!k||h&16)&&re(r,"working",e[4]===U.WORKING);const H={};h&16&&(H.status=e[4]),S.$set(H)},i(e){k||(he(S.$$.fragment,e),k=!0)},o(e){Ue(S.$$.fragment,e),k=!1},d(e){e&&c(w),e&&c(s),ge(S),X=!1,Ie(ee)}}}function Se(n,w,s){let u,r;oe(n,x,l=>s(14,u=l)),oe(n,Ee,l=>s(5,r=l));let o=u.userName,g="",E="",A=!1,a=U.IDLE;async function B(){s(4,a=U.WORKING);const l=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(l.status===200){const C=await l.json();return s(4,a=U.SUCCESS),C.userName}return l.status===400&&s(4,a=U.ERROR_INVALID),l.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function m(l,C,p=void 0){s(4,a=U.WORKING);const N=new URLSearchParams;N.set("userID",l),N.set("username",C),p&&N.set("adminUserID",p);const _=await fetch(`${r.sponsorBlockApi}/api/setUsername?${N}`,{method:"POST"});_.status===200&&(s(4,a=U.SUCCESS),await ve()),_.status===400&&s(4,a=U.ERROR_INVALID),_.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function L(){s(0,o=await B()),ue(x,u.userName=o,u),ue(x,u._lastUpdateTime=Date.now(),u)}function G(){o=this.value,s(0,o)}const W=async l=>{await m(r.privateUUID,o),await L()};function i(){E=this.value,s(2,E)}const D=l=>{s(3,A=De(E))};function K(){g=this.value,s(1,g)}return[o,g,E,A,a,r,m,L,G,W,i,D,K,l=>{m(E,g,r.privateUUID)}]}class Ce extends ie{constructor(w){super(),pe(this,w,Se,Re,_e,{})}}export{Ce as default};
