import{S as ie,i as pe,s as fe,a as T,k as c,q as Z,v as _e,W as ce,h as m,c as b,l as d,m as I,r as z,w as me,n as R,H as re,b as le,D as s,Z as W,x as de,I as K,f as he,t as Ue,y as ge,R as Ie,G as oe,U as ue}from"../../../chunks/index-57ef3195.js";import{C as Ee}from"../../../chunks/config-90b35c59.js";import{U as $}from"../../../chunks/userInfo-b63b04e5.js";import{u as Re,a as De}from"../../../chunks/utils-f53755c6.js";import{S as Ne}from"../../../chunks/Status-26ff45ac.js";import{S as i}from"../../../chunks/BaseStatus-314ac73e.js";function ve(n){let w,e,u,r,o,g,E,A,a,V,h,G,L,q,p,D,B,y,l,C,f,N,_,M,v,J,F,Q,O,k,X,ee;return O=new Ne({props:{status:n[4]}}),{c(){w=T(),e=c("main"),u=c("div"),r=c("div"),o=c("fieldset"),g=c("legend"),E=Z("Your Username:"),A=T(),a=c("input"),V=T(),h=c("button"),G=Z("Change"),q=T(),p=c("fieldset"),D=c("legend"),B=Z("Change Username: "),y=c("span"),l=Z("(Admin Only)"),C=T(),f=c("input"),N=T(),_=c("input"),M=T(),v=c("button"),J=Z("Update"),Q=T(),_e(O.$$.fragment),this.h()},l(t){ce('[data-svelte="svelte-azqn3g"]',document.head).forEach(m),w=b(t),e=d(t,"MAIN",{});var H=I(e);u=d(H,"DIV",{class:!0});var Y=I(u);r=d(Y,"DIV",{class:!0});var j=I(r);o=d(j,"FIELDSET",{});var P=I(o);g=d(P,"LEGEND",{});var te=I(g);E=z(te,"Your Username:"),te.forEach(m),A=b(P),a=d(P,"INPUT",{type:!0,placeholder:!0}),V=b(P),h=d(P,"BUTTON",{});var se=I(h);G=z(se,"Change"),se.forEach(m),P.forEach(m),q=b(j),p=d(j,"FIELDSET",{});var S=I(p);D=d(S,"LEGEND",{});var x=I(D);B=z(x,"Change Username: "),y=d(x,"SPAN",{class:!0});var ae=I(y);l=z(ae,"(Admin Only)"),ae.forEach(m),x.forEach(m),C=b(S),f=d(S,"INPUT",{type:!0,placeholder:!0}),N=b(S),_=d(S,"INPUT",{type:!0,placeholder:!0}),M=b(S),v=d(S,"BUTTON",{});var ne=I(v);J=z(ne,"Update"),ne.forEach(m),S.forEach(m),j.forEach(m),Q=b(Y),me(O.$$.fragment,Y),Y.forEach(m),H.forEach(m),this.h()},h(){document.title="Username | SponsorBlockControl",R(a,"type","text"),R(a,"placeholder","Username..."),h.disabled=L=n[0].length==0,R(y,"class","viprequired"),R(f,"type","text"),R(f,"placeholder","Target UUID..."),R(_,"type","text"),R(_,"placeholder","Username..."),v.disabled=F=!n[3]||n[1].length===0,R(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===i.WORKING),R(u,"class","container")},m(t,U){le(t,w,U),le(t,e,U),s(e,u),s(u,r),s(r,o),s(o,g),s(g,E),s(o,A),s(o,a),W(a,n[0]),s(o,V),s(o,h),s(h,G),s(r,q),s(r,p),s(p,D),s(D,B),s(D,y),s(y,l),s(p,C),s(p,f),W(f,n[2]),s(p,N),s(p,_),W(_,n[1]),s(p,M),s(p,v),s(v,J),s(u,Q),de(O,u,null),k=!0,X||(ee=[K(a,"input",n[8]),K(h,"click",n[9]),K(f,"input",n[10]),K(f,"input",n[11]),K(_,"input",n[12]),K(v,"click",n[13])],X=!0)},p(t,[U]){U&1&&a.value!==t[0]&&W(a,t[0]),(!k||U&1&&L!==(L=t[0].length==0))&&(h.disabled=L),U&4&&f.value!==t[2]&&W(f,t[2]),U&2&&_.value!==t[1]&&W(_,t[1]),(!k||U&10&&F!==(F=!t[3]||t[1].length===0))&&(v.disabled=F),(!k||U&16)&&re(r,"working",t[4]===i.WORKING);const H={};U&16&&(H.status=t[4]),O.$set(H)},i(t){k||(he(O.$$.fragment,t),k=!0)},o(t){Ue(O.$$.fragment,t),k=!1},d(t){t&&m(w),t&&m(e),ge(O),X=!1,Ie(ee)}}}function Oe(n,w,e){let u,r;oe(n,$,l=>e(14,u=l)),oe(n,Ee,l=>e(5,r=l));let o=u.userName,g="",E="",A=!1,a=i.IDLE;async function V(){e(4,a=i.WORKING);const l=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(l.status===200){const C=await l.json();return e(4,a=i.SUCCESS),C.userName}return l.status===400&&e(4,a=i.ERROR_INVALID),l.status===403&&e(4,a=i.ERROR_UNAUTHORIZED),a===i.WORKING&&e(4,a=i.ERROR_OTHER),""}async function h(l,C,f=void 0){e(4,a=i.WORKING);const N=new URLSearchParams;N.set("userID",l),N.set("username",C),f&&N.set("adminUserID",f);const _=await fetch(`${r.sponsorBlockApi}/api/setUsername?${N}`,{method:"POST"});_.status===200&&(e(4,a=i.SUCCESS),await Re()),_.status===400&&e(4,a=i.ERROR_INVALID),_.status===403&&e(4,a=i.ERROR_UNAUTHORIZED),a===i.WORKING&&e(4,a=i.ERROR_OTHER)}async function G(){e(0,o=await V()),ue($,u.userName=o,u),ue($,u._lastUpdateTime=Date.now(),u)}function L(){o=this.value,e(0,o)}const q=async l=>{await h(r.privateUUID,o),await G()};function p(){E=this.value,e(2,E)}const D=l=>{e(3,A=De(E))};function B(){g=this.value,e(1,g)}return[o,g,E,A,a,r,h,G,L,q,p,D,B,l=>{h(E,g,r.privateUUID)}]}class ke extends ie{constructor(w){super(),pe(this,w,Oe,ve,fe,{})}}export{ke as default};
