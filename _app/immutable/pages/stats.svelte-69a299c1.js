import{S as wt,i as gt,s as kt,e as n,t as b,k as C,c as r,a as i,h as E,d as o,m as w,b as T,g as q,H as t,J as Dt,j as F,w as It,a4 as Rt,x as yt,y as Lt,q as Ut,o as At,B as Bt,L as bt,v as Ht,W as Et}from"../chunks/index-6cd0ee1a.js";import{w as Nt,C as Ot}from"../chunks/config-68cbb0a0.js";import{a as G,S as Wt}from"../chunks/Status-3ba30f11.js";import{m as Tt}from"../chunks/utils-83ecb504.js";import"../chunks/index-b67d38aa.js";import"../chunks/userInfo-b3c97a05.js";const it=Nt("cache",{totalstats:{apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0},totalstats_time:0});function Ct(d){let _,a,s,h,c,v,l,e=d[1].apiUsers.toLocaleString()+"",p,f,m,y,Q,X,D,N=d[1].viewCount.toLocaleString()+"",K,Z,x,I,L,tt,et,U,O=d[1].totalSubmissions.toLocaleString()+"",M,st,R,A,at,lt,B,W=Tt(d[1].minutesSaved,!0)+"",j,P,H,g,ot,V,nt,ut;return{c(){_=n("table"),a=n("tbody"),s=n("tr"),h=n("th"),c=b("API Users:"),v=C(),l=n("td"),p=b(e),f=C(),m=n("tr"),y=n("th"),Q=b("Skip Count:"),X=C(),D=n("td"),K=b(N),Z=b(" skips"),x=C(),I=n("tr"),L=n("th"),tt=b("Submissions:"),et=C(),U=n("td"),M=b(O),st=C(),R=n("tr"),A=n("th"),at=b("Time Saved:"),lt=C(),B=n("td"),j=b(W),P=C(),H=n("div"),g=n("button"),ot=b("Refresh"),this.h()},l(u){_=r(u,"TABLE",{class:!0});var S=i(_);a=r(S,"TBODY",{});var k=i(a);s=r(k,"TR",{});var $=i(s);h=r($,"TH",{class:!0});var ct=i(h);c=E(ct,"API Users:"),ct.forEach(o),v=w($),l=r($,"TD",{class:!0});var ft=i(l);p=E(ft,e),ft.forEach(o),$.forEach(o),f=w(k),m=r(k,"TR",{});var z=i(m);y=r(z,"TH",{class:!0});var _t=i(y);Q=E(_t,"Skip Count:"),_t.forEach(o),X=w(z),D=r(z,"TD",{class:!0});var rt=i(D);K=E(rt,N),Z=E(rt," skips"),rt.forEach(o),z.forEach(o),x=w(k),I=r(k,"TR",{});var J=i(I);L=r(J,"TH",{class:!0});var dt=i(L);tt=E(dt,"Submissions:"),dt.forEach(o),et=w(J),U=r(J,"TD",{class:!0});var ht=i(U);M=E(ht,O),ht.forEach(o),J.forEach(o),st=w(k),R=r(k,"TR",{});var Y=i(R);A=r(Y,"TH",{class:!0});var mt=i(A);at=E(mt,"Time Saved:"),mt.forEach(o),lt=w(Y),B=r(Y,"TD",{class:!0});var vt=i(B);j=E(vt,W),vt.forEach(o),Y.forEach(o),k.forEach(o),S.forEach(o),P=w(u),H=r(u,"DIV",{});var pt=i(H);g=r(pt,"BUTTON",{});var St=i(g);ot=E(St,"Refresh"),St.forEach(o),pt.forEach(o),this.h()},h(){T(h,"class","svelte-n43nsu"),T(l,"class","svelte-n43nsu"),T(y,"class","svelte-n43nsu"),T(D,"class","svelte-n43nsu"),T(L,"class","svelte-n43nsu"),T(U,"class","svelte-n43nsu"),T(A,"class","svelte-n43nsu"),T(B,"class","svelte-n43nsu"),T(_,"class","stats-table svelte-n43nsu"),g.disabled=V=d[0]===G.WORKING},m(u,S){q(u,_,S),t(_,a),t(a,s),t(s,h),t(h,c),t(s,v),t(s,l),t(l,p),t(a,f),t(a,m),t(m,y),t(y,Q),t(m,X),t(m,D),t(D,K),t(D,Z),t(a,x),t(a,I),t(I,L),t(L,tt),t(I,et),t(I,U),t(U,M),t(a,st),t(a,R),t(R,A),t(A,at),t(R,lt),t(R,B),t(B,j),q(u,P,S),q(u,H,S),t(H,g),t(g,ot),nt||(ut=Dt(g,"click",d[3]),nt=!0)},p(u,S){S&2&&e!==(e=u[1].apiUsers.toLocaleString()+"")&&F(p,e),S&2&&N!==(N=u[1].viewCount.toLocaleString()+"")&&F(K,N),S&2&&O!==(O=u[1].totalSubmissions.toLocaleString()+"")&&F(M,O),S&2&&W!==(W=Tt(u[1].minutesSaved,!0)+"")&&F(j,W),S&1&&V!==(V=u[0]===G.WORKING)&&(g.disabled=V)},d(u){u&&o(_),u&&o(P),u&&o(H),nt=!1,ut()}}}function qt(d){let _,a,s,h,c,v,l=d[1]&&Ct(d);return c=new Wt({props:{status:d[0]}}),{c(){_=C(),a=n("main"),s=n("div"),l&&l.c(),h=C(),It(c.$$.fragment),this.h()},l(e){Rt('[data-svelte="svelte-15xz8eh"]',document.head).forEach(o),_=w(e),a=r(e,"MAIN",{});var f=i(a);s=r(f,"DIV",{class:!0});var m=i(s);l&&l.l(m),h=w(m),yt(c.$$.fragment,m),m.forEach(o),f.forEach(o),this.h()},h(){document.title="Stats | SponsorBlockControl",T(s,"class","container")},m(e,p){q(e,_,p),q(e,a,p),t(a,s),l&&l.m(s,null),t(s,h),Lt(c,s,null),v=!0},p(e,[p]){e[1]?l?l.p(e,p):(l=Ct(e),l.c(),l.m(s,h)):l&&(l.d(1),l=null);const f={};p&1&&(f.status=e[0]),c.$set(f)},i(e){v||(Ut(c.$$.fragment,e),v=!0)},o(e){At(c.$$.fragment,e),v=!1},d(e){e&&o(_),e&&o(a),l&&l.d(),Bt(c)}}}const Gt=6e5;function Kt(d,_,a){let s,h;bt(d,it,f=>a(4,s=f)),bt(d,Ot,f=>a(5,h=f));let c=G.IDLE,v={apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0};async function l(){a(0,c=G.WORKING);const f=await fetch(`${h.sponsorBlockApi}/api/getTotalStats`).then(m=>m.json());return a(0,c=G.SUCCESS),f}async function e(){a(1,v=await l()),Et(it,s.totalstats=v,s),Et(it,s.totalstats_time=Date.now(),s)}return Ht(async()=>{"totalstats"in s&&s.totalstats_time+Gt>Date.now()?a(1,v=s.totalstats):await e()}),[c,v,e,async f=>{await e()}]}class Jt extends wt{constructor(_){super(),gt(this,_,Kt,qt,kt,{})}}export{Jt as default};
