import{S as wt,i as gt,s as kt,e as n,t as b,k as C,c as r,a as i,h as E,d as o,m as w,b as T,g as G,H as t,J as Rt,j as Y,w as Dt,R as It,x as yt,y as Lt,q as Ut,o as At,B as Bt,L as bt,v as Ht,X as Et}from"../chunks/index-dfbae117.js";import{w as Nt,C as Ot}from"../chunks/config-fe9b9627.js";import{a as K,S as qt}from"../chunks/Status-73b605ec.js";import{m as Tt}from"../chunks/utils-fa7e4892.js";import"../chunks/index-9cf52d15.js";import"../chunks/userInfo-8e2fd6d8.js";const it=Nt("cache",{totalstats:{apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0},totalstats_time:0});function Ct(d){let _,a,s,h,c,v,l,e=d[1].apiUsers.toLocaleString()+"",p,f,m,y,F,Q,R,N=d[1].viewCount.toLocaleString()+"",M,Z,x,D,L,tt,et,U,O=d[1].totalSubmissions.toLocaleString()+"",W,st,I,A,at,lt,B,q=Tt(d[1].minutesSaved,!0)+"",j,P,H,g,ot,V,nt,ut;return{c(){_=n("table"),a=n("tbody"),s=n("tr"),h=n("th"),c=b("API Users:"),v=C(),l=n("td"),p=b(e),f=C(),m=n("tr"),y=n("th"),F=b("Skip Count:"),Q=C(),R=n("td"),M=b(N),Z=b(" skips"),x=C(),D=n("tr"),L=n("th"),tt=b("Submissions:"),et=C(),U=n("td"),W=b(O),st=C(),I=n("tr"),A=n("th"),at=b("Time Saved:"),lt=C(),B=n("td"),j=b(q),P=C(),H=n("div"),g=n("button"),ot=b("Refresh"),this.h()},l(u){_=r(u,"TABLE",{class:!0});var S=i(_);a=r(S,"TBODY",{});var k=i(a);s=r(k,"TR",{});var $=i(s);h=r($,"TH",{class:!0});var ct=i(h);c=E(ct,"API Users:"),ct.forEach(o),v=w($),l=r($,"TD",{class:!0});var ft=i(l);p=E(ft,e),ft.forEach(o),$.forEach(o),f=w(k),m=r(k,"TR",{});var z=i(m);y=r(z,"TH",{class:!0});var _t=i(y);F=E(_t,"Skip Count:"),_t.forEach(o),Q=w(z),R=r(z,"TD",{class:!0});var rt=i(R);M=E(rt,N),Z=E(rt," skips"),rt.forEach(o),z.forEach(o),x=w(k),D=r(k,"TR",{});var J=i(D);L=r(J,"TH",{class:!0});var dt=i(L);tt=E(dt,"Submissions:"),dt.forEach(o),et=w(J),U=r(J,"TD",{class:!0});var ht=i(U);W=E(ht,O),ht.forEach(o),J.forEach(o),st=w(k),I=r(k,"TR",{});var X=i(I);A=r(X,"TH",{class:!0});var mt=i(A);at=E(mt,"Time Saved:"),mt.forEach(o),lt=w(X),B=r(X,"TD",{class:!0});var vt=i(B);j=E(vt,q),vt.forEach(o),X.forEach(o),k.forEach(o),S.forEach(o),P=w(u),H=r(u,"DIV",{});var pt=i(H);g=r(pt,"BUTTON",{});var St=i(g);ot=E(St,"Refresh"),St.forEach(o),pt.forEach(o),this.h()},h(){T(h,"class","svelte-n43nsu"),T(l,"class","svelte-n43nsu"),T(y,"class","svelte-n43nsu"),T(R,"class","svelte-n43nsu"),T(L,"class","svelte-n43nsu"),T(U,"class","svelte-n43nsu"),T(A,"class","svelte-n43nsu"),T(B,"class","svelte-n43nsu"),T(_,"class","stats-table svelte-n43nsu"),g.disabled=V=d[0]===K.WORKING},m(u,S){G(u,_,S),t(_,a),t(a,s),t(s,h),t(h,c),t(s,v),t(s,l),t(l,p),t(a,f),t(a,m),t(m,y),t(y,F),t(m,Q),t(m,R),t(R,M),t(R,Z),t(a,x),t(a,D),t(D,L),t(L,tt),t(D,et),t(D,U),t(U,W),t(a,st),t(a,I),t(I,A),t(A,at),t(I,lt),t(I,B),t(B,j),G(u,P,S),G(u,H,S),t(H,g),t(g,ot),nt||(ut=Rt(g,"click",d[3]),nt=!0)},p(u,S){S&2&&e!==(e=u[1].apiUsers.toLocaleString()+"")&&Y(p,e),S&2&&N!==(N=u[1].viewCount.toLocaleString()+"")&&Y(M,N),S&2&&O!==(O=u[1].totalSubmissions.toLocaleString()+"")&&Y(W,O),S&2&&q!==(q=Tt(u[1].minutesSaved,!0)+"")&&Y(j,q),S&1&&V!==(V=u[0]===K.WORKING)&&(g.disabled=V)},d(u){u&&o(_),u&&o(P),u&&o(H),nt=!1,ut()}}}function Gt(d){let _,a,s,h,c,v,l=d[1]&&Ct(d);return c=new qt({props:{status:d[0]}}),{c(){_=C(),a=n("main"),s=n("div"),l&&l.c(),h=C(),Dt(c.$$.fragment),this.h()},l(e){It('[data-svelte="svelte-15xz8eh"]',document.head).forEach(o),_=w(e),a=r(e,"MAIN",{});var f=i(a);s=r(f,"DIV",{class:!0});var m=i(s);l&&l.l(m),h=w(m),yt(c.$$.fragment,m),m.forEach(o),f.forEach(o),this.h()},h(){document.title="Stats | SponsorBlockControl",T(s,"class","container")},m(e,p){G(e,_,p),G(e,a,p),t(a,s),l&&l.m(s,null),t(s,h),Lt(c,s,null),v=!0},p(e,[p]){e[1]?l?l.p(e,p):(l=Ct(e),l.c(),l.m(s,h)):l&&(l.d(1),l=null);const f={};p&1&&(f.status=e[0]),c.$set(f)},i(e){v||(Ut(c.$$.fragment,e),v=!0)},o(e){At(c.$$.fragment,e),v=!1},d(e){e&&o(_),e&&o(a),l&&l.d(),Bt(c)}}}const Kt=6e5;function Mt(d,_,a){let s,h;bt(d,it,f=>a(4,s=f)),bt(d,Ot,f=>a(5,h=f));let c=K.IDLE,v={apiUsers:0,userCount:0,viewCount:0,totalSubmissions:0,minutesSaved:0};async function l(){a(0,c=K.WORKING);const f=await fetch(`${h.sponsorBlockApi}/api/getTotalStats`).then(m=>m.json());return a(0,c=K.SUCCESS),f}async function e(){a(1,v=await l()),Et(it,s.totalstats=v,s),Et(it,s.totalstats_time=Date.now(),s)}return Ht(async()=>{"totalstats"in s&&s.totalstats_time+Kt>Date.now()?a(1,v=s.totalstats):await e()}),[c,v,e,async f=>{await e()}]}class Jt extends wt{constructor(_){super(),gt(this,_,Mt,Gt,kt,{})}}export{Jt as default};
