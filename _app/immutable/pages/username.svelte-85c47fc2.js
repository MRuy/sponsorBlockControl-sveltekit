import{S as ie,i as pe,s as _e,k as T,e as f,t as z,w as fe,a4 as me,d as m,m as O,c,a as I,h as F,x as ce,b as v,I as re,g as le,H as t,ab as G,y as de,J as P,q as he,o as Ue,B as ge,V as Ie,L as oe,W as ue}from"../chunks/index-6cd0ee1a.js";import{C as Ee}from"../chunks/config-68cbb0a0.js";import{U as J}from"../chunks/userInfo-b3c97a05.js";import{u as ve,a as Ne}from"../chunks/utils-83ecb504.js";import{S as De,a as U}from"../chunks/Status-3ba30f11.js";import"../chunks/index-b67d38aa.js";function Re(n){let w,s,l,r,u,g,E,k,a,q,d,A,L,W,i,N,K,y,o,C,p,D,_,M,R,Q,Y,X,b,V,$,ee;return b=new De({props:{status:n[4]}}),{c(){w=T(),s=f("main"),l=f("div"),r=f("div"),u=f("fieldset"),g=f("legend"),E=z("Your Username:"),k=T(),a=f("input"),q=T(),d=f("button"),A=z("Change"),W=T(),i=f("fieldset"),N=f("legend"),K=z("Change Username: "),y=f("span"),o=z("(Admin Only)"),C=T(),p=f("input"),D=T(),_=f("input"),M=T(),R=f("button"),Q=z("Update"),X=T(),fe(b.$$.fragment),this.h()},l(e){me('[data-svelte="svelte-azqn3g"]',document.head).forEach(m),w=O(e),s=c(e,"MAIN",{});var H=I(s);l=c(H,"DIV",{class:!0});var Z=I(l);r=c(Z,"DIV",{class:!0});var j=I(r);u=c(j,"FIELDSET",{});var B=I(u);g=c(B,"LEGEND",{});var te=I(g);E=F(te,"Your Username:"),te.forEach(m),k=O(B),a=c(B,"INPUT",{type:!0,placeholder:!0}),q=O(B),d=c(B,"BUTTON",{});var se=I(d);A=F(se,"Change"),se.forEach(m),B.forEach(m),W=O(j),i=c(j,"FIELDSET",{});var S=I(i);N=c(S,"LEGEND",{});var x=I(N);K=F(x,"Change Username: "),y=c(x,"SPAN",{class:!0});var ae=I(y);o=F(ae,"(Admin Only)"),ae.forEach(m),x.forEach(m),C=O(S),p=c(S,"INPUT",{type:!0,placeholder:!0}),D=O(S),_=c(S,"INPUT",{type:!0,placeholder:!0}),M=O(S),R=c(S,"BUTTON",{});var ne=I(R);Q=F(ne,"Update"),ne.forEach(m),S.forEach(m),j.forEach(m),X=O(Z),ce(b.$$.fragment,Z),Z.forEach(m),H.forEach(m),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),d.disabled=L=n[0].length==0,v(y,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(_,"type","text"),v(_,"placeholder","Username..."),R.disabled=Y=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(l,"class","container")},m(e,h){le(e,w,h),le(e,s,h),t(s,l),t(l,r),t(r,u),t(u,g),t(g,E),t(u,k),t(u,a),G(a,n[5].userName),t(u,q),t(u,d),t(d,A),t(r,W),t(r,i),t(i,N),t(N,K),t(N,y),t(y,o),t(i,C),t(i,p),G(p,n[2]),t(i,D),t(i,_),G(_,n[1]),t(i,M),t(i,R),t(R,Q),t(l,X),de(b,l,null),V=!0,$||(ee=[P(a,"input",n[9]),P(d,"click",n[10]),P(p,"input",n[11]),P(p,"input",n[12]),P(_,"input",n[13]),P(R,"click",n[14])],$=!0)},p(e,[h]){h&32&&a.value!==e[5].userName&&G(a,e[5].userName),(!V||h&1&&L!==(L=e[0].length==0))&&(d.disabled=L),h&4&&p.value!==e[2]&&G(p,e[2]),h&2&&_.value!==e[1]&&G(_,e[1]),(!V||h&10&&Y!==(Y=!e[3]||e[1].length===0))&&(R.disabled=Y),h&16&&re(r,"working",e[4]===U.WORKING);const H={};h&16&&(H.status=e[4]),b.$set(H)},i(e){V||(he(b.$$.fragment,e),V=!0)},o(e){Ue(b.$$.fragment,e),V=!1},d(e){e&&m(w),e&&m(s),ge(b),$=!1,Ie(ee)}}}function be(n,w,s){let l,r;oe(n,J,o=>s(5,l=o)),oe(n,Ee,o=>s(6,r=o));let u="",g="",E="",k=!1,a=U.IDLE;async function q(){s(4,a=U.WORKING);const o=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(o.status===200){const C=await o.json();return s(4,a=U.SUCCESS),C.userName}return o.status===400&&s(4,a=U.ERROR_INVALID),o.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function d(o,C,p=void 0){s(4,a=U.WORKING);const D=new URLSearchParams;D.set("userID",o),D.set("username",C),p&&D.set("adminUserID",p);const _=await fetch(`${r.sponsorBlockApi}/api/setUsername?${D}`,{method:"POST"});_.status===200&&(s(4,a=U.SUCCESS),await ve()),_.status===400&&s(4,a=U.ERROR_INVALID),_.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function A(){s(0,u=await q()),ue(J,l.userName=u,l),ue(J,l._lastUpdateTime=Date.now(),l)}function L(){l.userName=this.value,J.set(l)}const W=async o=>{await d(r.privateUUID,u),await A()};function i(){E=this.value,s(2,E)}const N=o=>{s(3,k=Ne(E))};function K(){g=this.value,s(1,g)}return[u,g,E,k,a,l,r,d,A,L,W,i,N,K,o=>{d(E,g,r.privateUUID)}]}class ke extends ie{constructor(w){super(),pe(this,w,be,Re,_e,{})}}export{ke as default};
