import{S as ie,i as pe,s as ce,k,e as d,t as H,j as de,P as fe,d as f,n as T,c as _,a as I,g as z,m as _e,b as v,G as re,f as le,E as t,a0 as P,o as me,H as V,x as he,u as Ue,v as ge,U as Ie,J as oe,W as ue}from"../chunks/vendor-9fba9fd8.js";import{C as Ee}from"../chunks/config-c3a6b1a1.js";import{U as J}from"../chunks/userInfo-65a70c4e.js";import{u as ve,a as Ne}from"../chunks/utils-5593b12d.js";import{a as De,S as U}from"../chunks/Status-de6d2c9d.js";function be(n){let O,s,l,r,u,g,E,y,a,B,m,A,L,W,i,N,q,C,o,w,p,D,c,M,b,Q,F,X,R,j,$,ee;return R=new De({props:{status:n[4]}}),{c(){O=k(),s=d("main"),l=d("div"),r=d("div"),u=d("fieldset"),g=d("legend"),E=H("Your Username:"),y=k(),a=d("input"),B=k(),m=d("button"),A=H("Change"),W=k(),i=d("fieldset"),N=d("legend"),q=H("Change Username: "),C=d("span"),o=H("(Admin Only)"),w=k(),p=d("input"),D=k(),c=d("input"),M=k(),b=d("button"),Q=H("Update"),X=k(),de(R.$$.fragment),this.h()},l(e){fe('[data-svelte="svelte-azqn3g"]',document.head).forEach(f),O=T(e),s=_(e,"MAIN",{});var K=I(s);l=_(K,"DIV",{class:!0});var Y=I(l);r=_(Y,"DIV",{class:!0});var Z=I(r);u=_(Z,"FIELDSET",{});var G=I(u);g=_(G,"LEGEND",{});var te=I(g);E=z(te,"Your Username:"),te.forEach(f),y=T(G),a=_(G,"INPUT",{type:!0,placeholder:!0}),B=T(G),m=_(G,"BUTTON",{});var se=I(m);A=z(se,"Change"),se.forEach(f),G.forEach(f),W=T(Z),i=_(Z,"FIELDSET",{});var S=I(i);N=_(S,"LEGEND",{});var x=I(N);q=z(x,"Change Username: "),C=_(x,"SPAN",{class:!0});var ae=I(C);o=z(ae,"(Admin Only)"),ae.forEach(f),x.forEach(f),w=T(S),p=_(S,"INPUT",{type:!0,placeholder:!0}),D=T(S),c=_(S,"INPUT",{type:!0,placeholder:!0}),M=T(S),b=_(S,"BUTTON",{});var ne=I(b);Q=z(ne,"Update"),ne.forEach(f),S.forEach(f),Z.forEach(f),X=T(Y),_e(R.$$.fragment,Y),Y.forEach(f),K.forEach(f),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),m.disabled=L=n[0].length==0,v(C,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(c,"type","text"),v(c,"placeholder","Username..."),b.disabled=F=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(l,"class","container")},m(e,h){le(e,O,h),le(e,s,h),t(s,l),t(l,r),t(r,u),t(u,g),t(g,E),t(u,y),t(u,a),P(a,n[5].userName),t(u,B),t(u,m),t(m,A),t(r,W),t(r,i),t(i,N),t(N,q),t(N,C),t(C,o),t(i,w),t(i,p),P(p,n[2]),t(i,D),t(i,c),P(c,n[1]),t(i,M),t(i,b),t(b,Q),t(l,X),me(R,l,null),j=!0,$||(ee=[V(a,"input",n[9]),V(m,"click",n[10]),V(p,"input",n[11]),V(p,"input",n[12]),V(c,"input",n[13]),V(b,"click",n[14])],$=!0)},p(e,[h]){h&32&&a.value!==e[5].userName&&P(a,e[5].userName),(!j||h&1&&L!==(L=e[0].length==0))&&(m.disabled=L),h&4&&p.value!==e[2]&&P(p,e[2]),h&2&&c.value!==e[1]&&P(c,e[1]),(!j||h&10&&F!==(F=!e[3]||e[1].length===0))&&(b.disabled=F),h&16&&re(r,"working",e[4]===U.WORKING);const K={};h&16&&(K.status=e[4]),R.$set(K)},i(e){j||(he(R.$$.fragment,e),j=!0)},o(e){Ue(R.$$.fragment,e),j=!1},d(e){e&&f(O),e&&f(s),ge(R),$=!1,Ie(ee)}}}function Re(n,O,s){let l,r;oe(n,J,o=>s(5,l=o)),oe(n,Ee,o=>s(6,r=o));let u="",g="",E="",y=!1,a=U.IDLE;async function B(){s(4,a=U.WORKING);const o=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(o.status===200){const w=await o.json();return s(4,a=U.SUCCESS),w.userName}return o.status===400&&s(4,a=U.ERROR_INVALID),o.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function m(o,w,p=void 0){s(4,a=U.WORKING);const D=new URLSearchParams;D.set("userID",o),D.set("username",w),p&&D.set("adminUserID",p);const c=await fetch(`${r.sponsorBlockApi}/api/setUsername?${D}`,{method:"POST"});c.status===200&&(s(4,a=U.SUCCESS),await ve()),c.status===400&&s(4,a=U.ERROR_INVALID),c.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function A(){s(0,u=await B()),ue(J,l.userName=u,l),ue(J,l._lastUpdateTime=Date.now(),l)}function L(){l.userName=this.value,J.set(l)}const W=async o=>{await m(r.privateUUID,u),await A()};function i(){E=this.value,s(2,E)}const N=o=>{s(3,y=Ne(E))};function q(){g=this.value,s(1,g)}return[u,g,E,y,a,l,r,m,A,L,W,i,N,q,o=>{m(E,g,r.privateUUID)}]}class we extends ie{constructor(O){super();pe(this,O,Re,be,ce,{})}}export{we as default};
