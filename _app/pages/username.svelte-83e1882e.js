import{S as ie,i as pe,s as ce,k,e as f,t as Y,w as fe,R as de,d,m as T,c as _,a as I,h as z,x as _e,b as v,I as re,g as le,G as t,a1 as B,y as me,J as P,q as he,o as Ue,B as ge,W as Ie,L as oe,Y as ue}from"../chunks/vendor-029251f6.js";import{C as Ee}from"../chunks/config-b3d4a71f.js";import{U as J}from"../chunks/userInfo-a6af26e4.js";import{u as ve,a as Ne}from"../chunks/utils-3b98a7b3.js";import{a as De,S as U}from"../chunks/Status-95729226.js";function be(n){let O,s,l,r,u,g,E,C,a,V,m,A,L,q,i,N,W,w,o,y,p,D,c,M,b,Q,F,X,R,G,$,ee;return R=new De({props:{status:n[4]}}),{c(){O=k(),s=f("main"),l=f("div"),r=f("div"),u=f("fieldset"),g=f("legend"),E=Y("Your Username:"),C=k(),a=f("input"),V=k(),m=f("button"),A=Y("Change"),q=k(),i=f("fieldset"),N=f("legend"),W=Y("Change Username: "),w=f("span"),o=Y("(Admin Only)"),y=k(),p=f("input"),D=k(),c=f("input"),M=k(),b=f("button"),Q=Y("Update"),X=k(),fe(R.$$.fragment),this.h()},l(e){de('[data-svelte="svelte-azqn3g"]',document.head).forEach(d),O=T(e),s=_(e,"MAIN",{});var K=I(s);l=_(K,"DIV",{class:!0});var H=I(l);r=_(H,"DIV",{class:!0});var Z=I(r);u=_(Z,"FIELDSET",{});var j=I(u);g=_(j,"LEGEND",{});var te=I(g);E=z(te,"Your Username:"),te.forEach(d),C=T(j),a=_(j,"INPUT",{type:!0,placeholder:!0}),V=T(j),m=_(j,"BUTTON",{});var se=I(m);A=z(se,"Change"),se.forEach(d),j.forEach(d),q=T(Z),i=_(Z,"FIELDSET",{});var S=I(i);N=_(S,"LEGEND",{});var x=I(N);W=z(x,"Change Username: "),w=_(x,"SPAN",{class:!0});var ae=I(w);o=z(ae,"(Admin Only)"),ae.forEach(d),x.forEach(d),y=T(S),p=_(S,"INPUT",{type:!0,placeholder:!0}),D=T(S),c=_(S,"INPUT",{type:!0,placeholder:!0}),M=T(S),b=_(S,"BUTTON",{});var ne=I(b);Q=z(ne,"Update"),ne.forEach(d),S.forEach(d),Z.forEach(d),X=T(H),_e(R.$$.fragment,H),H.forEach(d),K.forEach(d),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),m.disabled=L=n[0].length==0,v(w,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(c,"type","text"),v(c,"placeholder","Username..."),b.disabled=F=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(l,"class","container")},m(e,h){le(e,O,h),le(e,s,h),t(s,l),t(l,r),t(r,u),t(u,g),t(g,E),t(u,C),t(u,a),B(a,n[5].userName),t(u,V),t(u,m),t(m,A),t(r,q),t(r,i),t(i,N),t(N,W),t(N,w),t(w,o),t(i,y),t(i,p),B(p,n[2]),t(i,D),t(i,c),B(c,n[1]),t(i,M),t(i,b),t(b,Q),t(l,X),me(R,l,null),G=!0,$||(ee=[P(a,"input",n[9]),P(m,"click",n[10]),P(p,"input",n[11]),P(p,"input",n[12]),P(c,"input",n[13]),P(b,"click",n[14])],$=!0)},p(e,[h]){h&32&&a.value!==e[5].userName&&B(a,e[5].userName),(!G||h&1&&L!==(L=e[0].length==0))&&(m.disabled=L),h&4&&p.value!==e[2]&&B(p,e[2]),h&2&&c.value!==e[1]&&B(c,e[1]),(!G||h&10&&F!==(F=!e[3]||e[1].length===0))&&(b.disabled=F),h&16&&re(r,"working",e[4]===U.WORKING);const K={};h&16&&(K.status=e[4]),R.$set(K)},i(e){G||(he(R.$$.fragment,e),G=!0)},o(e){Ue(R.$$.fragment,e),G=!1},d(e){e&&d(O),e&&d(s),ge(R),$=!1,Ie(ee)}}}function Re(n,O,s){let l,r;oe(n,J,o=>s(5,l=o)),oe(n,Ee,o=>s(6,r=o));let u="",g="",E="",C=!1,a=U.IDLE;async function V(){s(4,a=U.WORKING);const o=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(o.status===200){const y=await o.json();return s(4,a=U.SUCCESS),y.userName}return o.status===400&&s(4,a=U.ERROR_INVALID),o.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function m(o,y,p=void 0){s(4,a=U.WORKING);const D=new URLSearchParams;D.set("userID",o),D.set("username",y),p&&D.set("adminUserID",p);const c=await fetch(`${r.sponsorBlockApi}/api/setUsername?${D}`,{method:"POST"});c.status===200&&(s(4,a=U.SUCCESS),await ve()),c.status===400&&s(4,a=U.ERROR_INVALID),c.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function A(){s(0,u=await V()),ue(J,l.userName=u,l),ue(J,l._lastUpdateTime=Date.now(),l)}function L(){l.userName=this.value,J.set(l)}const q=async o=>{await m(r.privateUUID,u),await A()};function i(){E=this.value,s(2,E)}const N=o=>{s(3,C=Ne(E))};function W(){g=this.value,s(1,g)}return[u,g,E,C,a,l,r,m,A,L,q,i,N,W,o=>{m(E,g,r.privateUUID)}]}class ye extends ie{constructor(O){super();pe(this,O,Re,be,ce,{})}}export{ye as default};
