import{S as ie,i as pe,s as ce,k as T,e as d,t as H,j as de,P as fe,d as f,n as k,c as _,a as I,g as z,m as _e,b as v,G as re,f as le,E as t,a0 as j,o as me,H as V,x as he,u as Ue,v as ge,U as Ie,J as oe,W as ue}from"../chunks/vendor-9fc4b0a7.js";import{U as J,C as Ee}from"../chunks/stores-1663c3e2.js";import{u as ve,a as Ne}from"../chunks/utils-dd30e544.js";import{a as Se,S as U}from"../chunks/Status-10cd6735.js";function De(n){let O,s,l,r,u,g,E,y,a,B,m,A,L,W,i,N,q,C,o,w,p,S,c,M,D,Q,F,X,R,G,$,ee;return R=new Se({props:{status:n[4]}}),{c(){O=T(),s=d("main"),l=d("div"),r=d("div"),u=d("fieldset"),g=d("legend"),E=H("Your Username:"),y=T(),a=d("input"),B=T(),m=d("button"),A=H("Change"),W=T(),i=d("fieldset"),N=d("legend"),q=H("Change Username: "),C=d("span"),o=H("(Admin Only)"),w=T(),p=d("input"),S=T(),c=d("input"),M=T(),D=d("button"),Q=H("Update"),X=T(),de(R.$$.fragment),this.h()},l(e){fe('[data-svelte="svelte-azqn3g"]',document.head).forEach(f),O=k(e),s=_(e,"MAIN",{});var K=I(s);l=_(K,"DIV",{class:!0});var Y=I(l);r=_(Y,"DIV",{class:!0});var Z=I(r);u=_(Z,"FIELDSET",{});var P=I(u);g=_(P,"LEGEND",{});var te=I(g);E=z(te,"Your Username:"),te.forEach(f),y=k(P),a=_(P,"INPUT",{type:!0,placeholder:!0}),B=k(P),m=_(P,"BUTTON",{});var se=I(m);A=z(se,"Change"),se.forEach(f),P.forEach(f),W=k(Z),i=_(Z,"FIELDSET",{});var b=I(i);N=_(b,"LEGEND",{});var x=I(N);q=z(x,"Change Username: "),C=_(x,"SPAN",{class:!0});var ae=I(C);o=z(ae,"(Admin Only)"),ae.forEach(f),x.forEach(f),w=k(b),p=_(b,"INPUT",{type:!0,placeholder:!0}),S=k(b),c=_(b,"INPUT",{type:!0,placeholder:!0}),M=k(b),D=_(b,"BUTTON",{});var ne=I(D);Q=z(ne,"Update"),ne.forEach(f),b.forEach(f),Z.forEach(f),X=k(Y),_e(R.$$.fragment,Y),Y.forEach(f),K.forEach(f),this.h()},h(){document.title="Username | SponsorBlockControl",v(a,"type","text"),v(a,"placeholder","Username..."),m.disabled=L=n[0].length==0,v(C,"class","viprequired"),v(p,"type","text"),v(p,"placeholder","Target UUID..."),v(c,"type","text"),v(c,"placeholder","Username..."),D.disabled=F=!n[3]||n[1].length===0,v(r,"class","form svelte-1czas0g"),re(r,"working",n[4]===U.WORKING),v(l,"class","container")},m(e,h){le(e,O,h),le(e,s,h),t(s,l),t(l,r),t(r,u),t(u,g),t(g,E),t(u,y),t(u,a),j(a,n[5].userName),t(u,B),t(u,m),t(m,A),t(r,W),t(r,i),t(i,N),t(N,q),t(N,C),t(C,o),t(i,w),t(i,p),j(p,n[2]),t(i,S),t(i,c),j(c,n[1]),t(i,M),t(i,D),t(D,Q),t(l,X),me(R,l,null),G=!0,$||(ee=[V(a,"input",n[9]),V(m,"click",n[10]),V(p,"input",n[11]),V(p,"input",n[12]),V(c,"input",n[13]),V(D,"click",n[14])],$=!0)},p(e,[h]){h&32&&a.value!==e[5].userName&&j(a,e[5].userName),(!G||h&1&&L!==(L=e[0].length==0))&&(m.disabled=L),h&4&&p.value!==e[2]&&j(p,e[2]),h&2&&c.value!==e[1]&&j(c,e[1]),(!G||h&10&&F!==(F=!e[3]||e[1].length===0))&&(D.disabled=F),h&16&&re(r,"working",e[4]===U.WORKING);const K={};h&16&&(K.status=e[4]),R.$set(K)},i(e){G||(he(R.$$.fragment,e),G=!0)},o(e){Ue(R.$$.fragment,e),G=!1},d(e){e&&f(O),e&&f(s),ge(R),$=!1,Ie(ee)}}}function Re(n,O,s){let l,r;oe(n,J,o=>s(5,l=o)),oe(n,Ee,o=>s(6,r=o));let u="",g="",E="",y=!1,a=U.IDLE;async function B(){s(4,a=U.WORKING);const o=await fetch(`${r.sponsorBlockApi}/api/getUsername?userID=${r.privateUUID}`);if(o.status===200){const w=await o.json();return s(4,a=U.SUCCESS),w.userName}return o.status===400&&s(4,a=U.ERROR_INVALID),o.status===403&&s(4,a=U.ERROR_UNAUTHORIZED),""}async function m(o,w,p=void 0){s(4,a=U.WORKING);const S=new URLSearchParams;S.set("userID",o),S.set("username",w),p&&S.set("adminUserID",p);const c=await fetch(`${r.sponsorBlockApi}/api/setUsername?${S}`,{method:"POST"});c.status===200&&(s(4,a=U.SUCCESS),await ve()),c.status===400&&s(4,a=U.ERROR_INVALID),c.status===403&&s(4,a=U.ERROR_UNAUTHORIZED)}async function A(){s(0,u=await B()),ue(J,l.userName=u,l),ue(J,l._lastUpdateTime=Date.now(),l)}function L(){l.userName=this.value,J.set(l)}const W=async o=>{await m(r.privateUUID,u),await A()};function i(){E=this.value,s(2,E)}const N=o=>{s(3,y=Ne(E))};function q(){g=this.value,s(1,g)}return[u,g,E,y,a,l,r,m,A,L,W,i,N,q,o=>{m(E,g,r.privateUUID)}]}class Ce extends ie{constructor(O){super();pe(this,O,Re,De,ce,{})}}export{Ce as default};
